# Containerlab Topology: Virtual Switch Network Validation Lab
# 
# Topology:
#   - sonic1 and sonic2: Linux switches with L2 bridges
#   - ptfhost: PTF traffic generator with 4 test ports
#
# Connections:
#   ptfhost:eth1 <-> sonic1:eth2  (VLAN100 access port 1)
#   ptfhost:eth2 <-> sonic1:eth3  (VLAN100 access port 2)
#   ptfhost:eth3 <-> sonic2:eth2  (VLAN100 access port 1)
#   ptfhost:eth4 <-> sonic2:eth3  (VLAN100 access port 2)
#   sonic1:eth1  <-> sonic2:eth1  (Inter-switch L3 routed link)

name: sonic-lab

topology:
  nodes:
    sonic1:
      kind: linux
      image: sonic-lab-switch:latest

    sonic2:
      kind: linux
      image: sonic-lab-switch:latest

    ptfhost:
      kind: linux
      image: sonic-lab-ptfhost:latest

  links:
    # Inter-switch L3 link
    - endpoints: ["sonic1:eth1", "sonic2:eth1"]
    
    # sonic1 L2 ports to ptfhost (for L2 forwarding tests)
    - endpoints: ["sonic1:eth2", "ptfhost:eth1"]
    - endpoints: ["sonic1:eth3", "ptfhost:eth2"]
    
    # sonic2 L2 ports to ptfhost (for L2 forwarding tests)
    - endpoints: ["sonic2:eth2", "ptfhost:eth3"]
    - endpoints: ["sonic2:eth3", "ptfhost:eth4"]
